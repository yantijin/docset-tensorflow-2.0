<div itemscope itemtype="http://developers.google.com/ReferenceObject">
<meta itemprop="name" content="tf.config.experimental.set_virtual_device_configuration" />
<meta itemprop="path" content="Stable" />
</div>


<h1>tf.config.experimental.set_virtual_device_configuration</h1>

<!-- Insert buttons -->




<table class="tfo-notebook-buttons tfo-api" align="left">
</table>


<p><a target="_blank" href="/code/stable/tensorflow/python/framework/config.py">View source</a></p>

<!-- Start diff -->


<p>Set the virtual device configuration for a PhysicalDevice.</p>

<h3>Aliases:</h3>

<ul>
<li><code>tf.compat.v1.config.experimental.set_virtual_device_configuration</code></li>
<li><code>tf.compat.v2.config.experimental.set_virtual_device_configuration</code></li>
</ul>


<p><code>python
tf.config.experimental.set_virtual_device_configuration(
    device,
    virtual_devices
)
</code></p>

<!-- Placeholder for "Used in" -->


<p>A PhysicalDevice marked as visible will by default have a single LogicalDevice
allocated to it once the runtime is configured. Specifying a list of
tf.config.experimental.VirtualDeviceConfiguration objects allows multiple
devices to be configured that utilize the same PhysicalDevice.</p>

<p>The following example splits the CPU into 2 virtual devices:</p>

<p>```python
physical_devices = tf.config.experimental.list_physical_devices(&lsquo;CPU&rsquo;)
assert len(physical_devices) == 1, &ldquo;No CPUs found&rdquo;</p>

<h1>Specify 2 virtual CPUs. Note currently memory limit is not supported.</h1>

<p>tf.config.experimental.set_virtual_device_configuration(
  physical_devices[0],
  [tf.config.experimental.VirtualDeviceConfiguration(),
   tf.config.experimental.VirtualDeviceConfiguration()])
logical_devices = tf.config.experimental.list_logical_devices(&lsquo;CPU&rsquo;)
assert len(logical_devices) == 2</p>

<p>try:
  tf.config.experimental.set_virtual_device_configuration(
    physical_devices[0],
    [tf.config.experimental.VirtualDeviceConfiguration(),
     tf.config.experimental.VirtualDeviceConfiguration(),
     tf.config.experimental.VirtualDeviceConfiguration(),
     tf.config.experimental.VirtualDeviceConfiguration()])
except:
  print(&lsquo;Cannot modify the virtual devices once they have been initialized.&rsquo;)
```</p>

<p>The following example splits the GPU into 2 virtual devices with 100 MB each:</p>

<p>```python
physical_devices = tf.config.experimental.list_physical_devices(&lsquo;GPU&rsquo;)
assert len(physical_devices) > 0, &ldquo;No GPUs found&rdquo;
tf.config.experimental.set_virtual_device_configuration(
  physical_devices[0],
  [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=100),
   tf.config.experimental.VirtualDeviceConfiguration(memory_limit=100)])</p>

<p>try:
  tf.config.experimental.set_memory_growth(physical_devices[0], True)
except:
  print(&lsquo;Cannot set memory growth when virtual devices configured&rsquo;)</p>

<p>logical_devices = tf.config.experimental.list_logical_devices(&lsquo;GPU&rsquo;)
assert len(logical_devices) == len(physical_devices) + 1</p>

<p>try:
  tf.config.experimental.set_virtual_device_configuration(
    physical_devices[0],
    [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=10),
     tf.config.experimental.VirtualDeviceConfiguration(memory_limit=10)])
except:
  print(&lsquo;Cannot modify the virtual devices once they have been initialized.&rsquo;)
```</p>

<h4>Args:</h4>

<ul>
<li><b><code>device</code></b>: (optional) Need to update</li>
<li><b><code>virtual_devices</code></b>: (optional) Need to update</li>
</ul>

