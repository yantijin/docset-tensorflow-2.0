<div itemscope itemtype="http://developers.google.com/ReferenceObject">
<meta itemprop="name" content="tf.random.set_seed" />
<meta itemprop="path" content="Stable" />
</div>


<h1>tf.random.set_seed</h1>

<!-- Insert buttons -->




<table class="tfo-notebook-buttons tfo-api" align="left">
</table>


<p><a target="_blank" href="/code/stable/tensorflow/python/framework/random_seed.py">View source</a></p>

<!-- Start diff -->


<p>Sets the graph-level random seed.</p>

<h3>Aliases:</h3>

<ul>
<li><code>tf.compat.v2.random.set_seed</code></li>
</ul>


<p><code>python
tf.random.set_seed(seed)
</code></p>

<!-- Placeholder for "Used in" -->


<p>Operations that rely on a random seed actually derive it from two seeds:
the graph-level and operation-level seeds. This sets the graph-level seed.</p>

<p>Its interactions with operation-level seeds is as follows:</p>

<ol>
<li>If neither the graph-level nor the operation seed is set:
A random seed is used for this op.</li>
<li>If the graph-level seed is set, but the operation seed is not:
The system deterministically picks an operation seed in conjunction
with the graph-level seed so that it gets a unique random sequence.</li>
<li>If the graph-level seed is not set, but the operation seed is set:
A default graph-level seed and the specified operation seed are used to
determine the random sequence.</li>
<li>If both the graph-level and the operation seed are set:
Both seeds are used in conjunction to determine the random sequence.</li>
</ol>


<p>To illustrate the user-visible effects, consider these examples:</p>

<p>To generate different sequences across sessions, set neither
graph-level nor op-level seeds:</p>

<p>```python
a = tf.random.uniform([1])
b = tf.random.normal([1])</p>

<p>print(&ldquo;Session 1&rdquo;)
with tf.compat.v1.Session() as sess1:
  print(sess1.run(a))  # generates &lsquo;A1&rsquo;
  print(sess1.run(a))  # generates &lsquo;A2&rsquo;
  print(sess1.run(b))  # generates &lsquo;B1&rsquo;
  print(sess1.run(b))  # generates &lsquo;B2&rsquo;</p>

<p>print(&ldquo;Session 2&rdquo;)
with tf.compat.v1.Session() as sess2:
  print(sess2.run(a))  # generates &lsquo;A3&rsquo;
  print(sess2.run(a))  # generates &lsquo;A4&rsquo;
  print(sess2.run(b))  # generates &lsquo;B3&rsquo;
  print(sess2.run(b))  # generates &lsquo;B4&rsquo;
```</p>

<p>To generate the same repeatable sequence for an op across sessions, set the
seed for the op:</p>

<p>```python
a = tf.random.uniform([1], seed=1)
b = tf.random.normal([1])</p>

<h1>Repeatedly running this block with the same graph will generate the same</h1>

<h1>sequence of values for &lsquo;a&rsquo;, but different sequences of values for &lsquo;b&rsquo;.</h1>

<p>print(&ldquo;Session 1&rdquo;)
with tf.compat.v1.Session() as sess1:
  print(sess1.run(a))  # generates &lsquo;A1&rsquo;
  print(sess1.run(a))  # generates &lsquo;A2&rsquo;
  print(sess1.run(b))  # generates &lsquo;B1&rsquo;
  print(sess1.run(b))  # generates &lsquo;B2&rsquo;</p>

<p>print(&ldquo;Session 2&rdquo;)
with tf.compat.v1.Session() as sess2:
  print(sess2.run(a))  # generates &lsquo;A1&rsquo;
  print(sess2.run(a))  # generates &lsquo;A2&rsquo;
  print(sess2.run(b))  # generates &lsquo;B3&rsquo;
  print(sess2.run(b))  # generates &lsquo;B4&rsquo;
```</p>

<p>To make the random sequences generated by all ops be repeatable across
sessions, set a graph-level seed:</p>

<p>```python
tf.random.set_seed(1234)
a = tf.random.uniform([1])
b = tf.random.normal([1])</p>

<h1>Repeatedly running this block with the same graph will generate the same</h1>

<h1>sequences of &lsquo;a&rsquo; and &lsquo;b&rsquo;.</h1>

<p>print(&ldquo;Session 1&rdquo;)
with tf.compat.v1.Session() as sess1:
  print(sess1.run(a))  # generates &lsquo;A1&rsquo;
  print(sess1.run(a))  # generates &lsquo;A2&rsquo;
  print(sess1.run(b))  # generates &lsquo;B1&rsquo;
  print(sess1.run(b))  # generates &lsquo;B2&rsquo;</p>

<p>print(&ldquo;Session 2&rdquo;)
with tf.compat.v1.Session() as sess2:
  print(sess2.run(a))  # generates &lsquo;A1&rsquo;
  print(sess2.run(a))  # generates &lsquo;A2&rsquo;
  print(sess2.run(b))  # generates &lsquo;B1&rsquo;
  print(sess2.run(b))  # generates &lsquo;B2&rsquo;
```</p>

<h4>Args:</h4>

<ul>
<li><b><code>seed</code></b>: integer.</li>
</ul>

