
    <html lang="zh-cn">
    <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <link href=../../../default.css" rel="stylesheet">
    <link href="
   ../../../github.css" rel="stylesheet">
    </head>
    <body>
    <div itemscope itemtype="http://developers.google.com/ReferenceObject">
<meta itemprop="name" content="tf.image.ssim" />
<meta itemprop="path" content="Stable" />
</div>

<h1 id="tfimagessim">tf.image.ssim</h1>
<!-- Insert buttons -->

<table class="tfo-notebook-buttons tfo-api" align="left">
</table>

<p><a target="_blank" href="/code/stable/tensorflow/python/ops/image_ops_impl.py">View source</a></p>
<!-- Start diff -->

<p>Computes SSIM index between img1 and img2.</p>
<h3 id="aliases">Aliases:</h3>
<ul>
<li><code>tf.compat.v1.image.ssim</code></li>
<li><code>tf.compat.v2.image.ssim</code></li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span>
    <span class="n">img1</span><span class="p">,</span>
    <span class="n">img2</span><span class="p">,</span>
    <span class="n">max_val</span><span class="p">,</span>
    <span class="n">filter_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="n">filter_sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">k1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">k2</span><span class="o">=</span><span class="mf">0.03</span>
<span class="p">)</span>
</pre></div>


<!-- Placeholder for "Used in" -->

<p>This function is based on the standard SSIM implementation from:
Wang, Z., Bovik, A. C., Sheikh, H. R., &amp; Simoncelli, E. P. (2004). Image
quality assessment: from error visibility to structural similarity. IEEE
transactions on image processing.</p>
<p>Note: The true SSIM is only defined on grayscale.  This function does not
perform any colorspace transform.  (If input is already YUV, then it will
compute YUV SSIM average.)</p>
<h4 id="details">Details:</h4>
<ul>
<li>11x11 Gaussian filter of width 1.5 is used.</li>
<li>k1 = 0.01, k2 = 0.03 as in the original paper.</li>
</ul>
<p>The image sizes must be at least 11x11 because of the filter size.</p>
<h4 id="example">Example:</h4>
<div class="codehilite"><pre><span></span>    <span class="c1"># Read images from file.</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">decode_png</span><span class="p">(</span><span class="s1">&#39;path/to/im1.png&#39;</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">decode_png</span><span class="p">(</span><span class="s1">&#39;path/to/im2.png&#39;</span><span class="p">)</span>
    <span class="c1"># Compute SSIM over tf.uint8 Tensors.</span>
    <span class="n">ssim1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">im2</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                          <span class="n">filter_sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

    <span class="c1"># Compute SSIM over tf.float32 Tensors.</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">convert_image_dtype</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">convert_image_dtype</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">ssim2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">im2</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                          <span class="n">filter_sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
    <span class="c1"># ssim1 and ssim2 both have type tf.float32 and are almost equal.</span>
</pre></div>


<h4 id="args">Args:</h4>
<ul>
<li><b><code>img1</code></b>: First image batch.</li>
<li><b><code>img2</code></b>: Second image batch.</li>
<li><b><code>max_val</code></b>: The dynamic range of the images (i.e., the difference between the
  maximum the and minimum allowed values).</li>
<li><b><code>filter_size</code></b>: Default value 11 (size of gaussian filter).</li>
<li><b><code>filter_sigma</code></b>: Default value 1.5 (width of gaussian filter).</li>
<li><b><code>k1</code></b>: Default value 0.01</li>
<li><b><code>k2</code></b>: Default value 0.03 (SSIM is less sensitivity to K2 for lower values, so
  it would be better if we taken the values in range of 0&lt; K2 &lt;0.4).</li>
</ul>
<h4 id="returns">Returns:</h4>
<p>A tensor containing an SSIM value for each image in batch.  Returned SSIM
values are in range (-1, 1], when pixel values are non-negative. Returns
a tensor with shape: broadcast(img1.shape[:-3], img2.shape[:-3]).</p>
    </body>
    </html>
   